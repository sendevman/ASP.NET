<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>ASP.NET Boilerplate documentation</title>
<link type="text/css" rel="stylesheet" href="bootstrap.min.css" />
<style type="text/css">
.auto-style1 {
	text-decoration: underline;
}
</style>
</head>

<body>

<ul>
	<li>Introduction</li>
	<li>Defining settings</li>
	<li>Getting setting values<ul>
		<li>Server side</li>
		<li>Client side</li>
	</ul>
	</li>
	<li>Changing settings</li>
</ul>
<h3 id="DocServerSide">Introduction</h3>
<p>Every application need to store some settings and use these settings in 
somewhere in the application. ASP.NET Boilerplate provides a flexible and strong 
infrastructure to store/retrieve <strong>application</strong>, <strong>tenant
</strong>and <strong>user</strong> level settings usable both in <strong>server
</strong>and <strong>client </strong>sides.</p>
<p>A setting is a <strong>name-value string</strong> pair that is generally 
stored in a database (or another source). We can store non-string values by 
converting to/from string (or serialize/deserialize).</p>

<div class="bs-callout bs-callout-warning"><h4>About ISettingStore</h4>
<p><span class="auto-style1">Note</span>: <strong>ISettingStore</strong> 
interface must be implemented in order to use setting system. While you can 
implement it in your own way, it's fully implemented in <strong>module-zero</strong> 
project.</p>
</div>

<h3 id="DocGetLogger">Defining settings</h3>
<p>A setting must be defined before usage. ASP.NET Boilerplate is designed to be 
modular. So, different modules can have different settings. A module should 
create a class derived from <strong>SettingProvider </strong>in order to define it's settings. 
An example setting provider is shown below:</p>
<pre lang="cs">public class MySettingProvider : SettingProvider
{
    public override IEnumerable&lt;SettingDefinition&gt; GetSettingDefinitions(SettingDefinitionProviderContext context)
    {
        return new[]
                {
                    new SettingDefinition(
                        &quot;SmtpServerAddress&quot;,
                        &quot;127.0.0.1&quot;
                        ),

                    new SettingDefinition(
                        &quot;PassiveUsersCanNotLogin&quot;,
                        &quot;true&quot;,
                        scopes: SettingScopes.Application | SettingScopes.Tenant
                        ),

                    new SettingDefinition(
                        &quot;SiteColorPreference&quot;,
                        &quot;red&quot;,
                        scopes: SettingScopes.User
                        )

                };
    }
}</pre>
<p><strong>GetSettingDefinitions</strong> method should return a list of <strong>
SettingDefinition</strong> objects. SettingDefinition class has different 
parameters in it's constructor:</p>
<ul>
	<li><strong>Setting name </strong>(required): A setting must have a 
	system-wide <strong>unique </strong>name.</li>
	<li><strong>Default value</strong>: A setting may have a default value. This 
	value can be null or empty string.</li>
	<li><strong>Scopes</strong>: A setting should define it's scope (see below).</li>
	<li><strong>Display name</strong>: A localizable string that can be used to 
	show setting's name in UI.</li>
	<li><strong>Description</strong>: A localizable string that can be used to 
	show setting's description in UI.</li>
	<li><strong>Group</strong>: Can be used to group settings. This is just for 
	UI, not used in setting management.</li>
</ul>
<h4>Setting scope</h4>
<p>&nbsp;There are three <strong>setting scopes</strong> (or levels) 
defined in <strong>SettingScopes</strong> enum:</p>
<ul>
	<li><strong>Application</strong>: An application scoped setting is used for 
	user/tenant independed settings. For example, we can define a setting named 
	"SmtpServerAddress" to get server's IP address when sending emails. If this 
	setting has a single value (not changes based on users), then we can define 
	it as Application scoped.</li>
	<li><strong>Tenant</strong>: If the application is multi-tenant, we can 
	define tenant-specific settings.</li>
	<li><strong>User</strong>: We can use a user scoped setting to store/get 
	value of the setting specific to each user.</li>
</ul>
<p>SettingScopes enum has <strong>Flags </strong>attribute, so we can define a 
setting with <strong>more than one scopes</strong>.</p>
<p>Setting scope is <strong>hierarchic</strong>. For example, if we define a 
setting's scope as "Application | Tenant | User" and try to get <strong>current value 
</strong>of the the 
setting;</p>
<ul>
	<li>We get the user-specific value if it's defined (overrided) by the user.</li>
	<li>If not, we get the tenant-specific value if it's defined (overrided) by 
	the tenant.</li>
	<li>If not, we get the application value if it's defined.</li>
	<li>If not, we get the <strong>default value</strong>.</li>
</ul>
<p>Default value can be <strong>null </strong>or <strong>empty </strong>string.</p>

<h3>Getting setting values</h3>
<p>After defining a setting, we can get it's current value both in server and 
client.</p>
<h4>Server side</h4>
<p><strong>ISettingManager </strong>should be used to perform setting 
operations. We can inject and use it anywhere in the application. 
ISettingManager defines many methods to get a setting's value.</p>
<p>Most used method is <strong>GetSettingValue </strong>(or GetSettingValueAsync 
for async call). It returns <strong>current value </strong>of the setting based 
on default value, application, tenant and user settings (as described in Setting 
scope section before). Example:</p>
<p>...</p>
<p>There are also methods to get a specific tenant or user's setting value or 
list of all setting values.</p>
<p>Since ISettingManager is widely used, some special base classes (like 
ApplicationService, DomainService and AppController) has a property named
<strong>SettingManager</strong>. If we derive from this classes, no need to 
explicitly inject it.</p>
<h4>Client side</h4>
<p>...</p>
<h3>Changing settings</h3>
<p>...</p>
<h4>About caching</h4>

<p>Setting Manager caches settings, so we should not directly change setting 
value using repositories or database update queries.</p>

</body>

</html>
